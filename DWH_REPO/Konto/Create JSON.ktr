<transformation>
  <info>
    <name>Create JSON</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;Konto</directory>
    <parameters>
    </parameters>
    <log>
<trans-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name><subject/></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name><subject/></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name><subject/></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name><subject/></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name><subject/></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name><subject/></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field><field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field><field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field><field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field></trans-log-table>
<perf-log-table><connection/>
<schema/>
<table/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>SEQ_NR</id><enabled>Y</enabled><name>SEQ_NR</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>INPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>INPUT_BUFFER_ROWS</name></field><field><id>OUTPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>OUTPUT_BUFFER_ROWS</name></field></perf-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
<step-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field></step-log-table>
<metrics-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>METRICS_DATE</id><enabled>Y</enabled><name>METRICS_DATE</name></field><field><id>METRICS_CODE</id><enabled>Y</enabled><name>METRICS_CODE</name></field><field><id>METRICS_DESCRIPTION</id><enabled>Y</enabled><name>METRICS_DESCRIPTION</name></field><field><id>METRICS_SUBJECT</id><enabled>Y</enabled><name>METRICS_SUBJECT</name></field><field><id>METRICS_TYPE</id><enabled>Y</enabled><name>METRICS_TYPE</name></field><field><id>METRICS_VALUE</id><enabled>Y</enabled><name>METRICS_VALUE</name></field></metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
  <created_user>-</created_user>
  <created_date>2017&#x2f;06&#x2f;30 10&#x3a;33&#x3a;49.209</created_date>
  <modified_user>-</modified_user>
  <modified_date>2017&#x2f;10&#x2f;18 11&#x3a;37&#x3a;12.517</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA&#x3d;</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>1.&#x29; Pobranie zapada&#x142;ych rat&#xd;&#xa;2.&#x29; Obr&#xf3;cenie wierszy w 1 kolumn&#x119;&#xd;&#xa;3.&#x29; Sort do joina  </note>
      <xloc>80</xloc>
      <yloc>496</yloc>
      <width>194</width>
      <heigth>58</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>1.&#x29; Pobranie wszystkich rat dla wniosk&#xf3;w&#xd;&#xa;2.&#x29; Obr&#xf3;cenie wierszy w 1 kolumn&#x119;&#xd;&#xa;3.&#x29; Sort do joina&#xd;&#xa;&#xd;&#xa;&#x2f;&#x2f; Wyszkluczone s&#x105; raz juz zapisane&#xd;&#xa;stratne umowy dla PDL 55 dla ILP 77</note>
      <xloc>16</xloc>
      <yloc>336</yloc>
      <width>224</width>
      <heigth>105</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>1.&#x29; Pobranie niezaraportowanych straconych um&#xf3;w&#xd;&#xa;2.&#x29; Po utworzeniu json&#xf3;w wpisywane s&#x105; do&#xd;&#xa;-&#x3e; tabeli OPER.t_kon_defaulted</note>
      <xloc>576</xloc>
      <yloc>496</yloc>
      <width>281</width>
      <heigth>58</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>1. &#x29; Tworzenie Tablicy do splitu</note>
      <xloc>656</xloc>
      <yloc>368</yloc>
      <width>173</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>DWH</name>
    <server>axc-dwh</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>DWH</database>
    <port>1521</port>
    <username>axcess</username>
    <password>Encrypted 2be98afc82ff3caa0b24b8448f386a58e</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>DWH - oper</name>
    <server>&#x24;&#x7b;ODS_HOST_DB&#x7d;</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>&#x24;&#x7b;ODS_DBNAME_DB&#x7d;</database>
    <port>1521</port>
    <username>&#x24;&#x7b;ODS_USER_OPER&#x7d;</username>
    <password>&#x24;&#x7b;ODS_PASS_OPER&#x7d;</password>
    <servername/>
    <data_tablespace>OPER_DATA_01</data_tablespace>
    <index_tablespace>OPER_INDX_01</index_tablespace>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
  <hop> <from>Raty</from><to>Group by raty</to><enabled>Y</enabled> </hop>
  <hop> <from>Get All WN</from><to>Group by wnioski</to><enabled>Y</enabled> </hop>
  <hop> <from>Create JSON</from><to>Select values</to><enabled>Y</enabled> </hop>
  <hop> <from>Select values</from><to>Insert Data</to><enabled>Y</enabled> </hop>
  <hop> <from>Sort by wniosek</from><to>Merge REPAID</to><enabled>Y</enabled> </hop>
  <hop> <from>Group by raty</from><to>Sort Raty</to><enabled>Y</enabled> </hop>
  <hop> <from>Sort Raty</from><to>umo and raty</to><enabled>Y</enabled> </hop>
  <hop> <from>Group by wnioski</from><to>Sort Nr Umowy</to><enabled>Y</enabled> </hop>
  <hop> <from>Insert Data</from><to>Abort</to><enabled>Y</enabled> </hop>
  <hop> <from>Select values</from><to>Count Rows</to><enabled>Y</enabled> </hop>
  <hop> <from>Sort Nr Umowy</from><to>umo and raty</to><enabled>Y</enabled> </hop>
  <hop> <from>Select values</from><to>Status defaulted &#x3f;</to><enabled>Y</enabled> </hop>
  <hop> <from>Status defaulted &#x3f;</from><to>Insert Defaulted</to><enabled>Y</enabled> </hop>
  <hop> <from>Status defaulted &#x3f;</from><to>Dummy Filtr</to><enabled>Y</enabled> </hop>
  <hop> <from>Merge Def</from><to>Create Arr JSON</to><enabled>Y</enabled> </hop>
  <hop> <from>Create Arr JSON</from><to>Add def</to><enabled>Y</enabled> </hop>
  <hop> <from>Add def</from><to>Drop Column</to><enabled>Y</enabled> </hop>
  <hop> <from>Raty Zapad&#x142;e data</from><to>Filter rows 2</to><enabled>Y</enabled> </hop>
  <hop> <from>Filter rows 2</from><to>Raty Zapad&#x142;e</to><enabled>Y</enabled> </hop>
  <hop> <from>Raty Zapad&#x142;e</from><to>Sort by wniosek</to><enabled>Y</enabled> </hop>
  <hop> <from>Get Def</from><to>Sort rows</to><enabled>Y</enabled> </hop>
  <hop> <from>Sort rows</from><to>Merge Def</to><enabled>Y</enabled> </hop>
  <hop> <from>Merge REPAID</from><to>Sort rows 2</to><enabled>Y</enabled> </hop>
  <hop> <from>Sort rows 2</from><to>Merge Def</to><enabled>Y</enabled> </hop>
  <hop> <from>umo and raty</from><to>Sort rows 3</to><enabled>Y</enabled> </hop>
  <hop> <from>Sort rows 3</from><to>Merge REPAID</to><enabled>Y</enabled> </hop>
  <hop> <from>Drop Column</from><to>Create JSON</to><enabled>Y</enabled> </hop>
  <hop> <from>Insert Defaulted</from><to>Abort</to><enabled>Y</enabled> </hop>
  <hop> <from>Select values</from><to>Status ods &#x3f;</to><enabled>Y</enabled> </hop>
  <hop> <from>Status ods &#x3f;</from><to>Dummy Filtr</to><enabled>Y</enabled> </hop>
  <hop> <from>Status ods &#x3f;</from><to>Insert ODS</to><enabled>Y</enabled> </hop>
  <hop> <from>Insert Defaulted</from><to>Count Def</to><enabled>Y</enabled> </hop>
  <hop> <from>Insert ODS</from><to>Count ODS</to><enabled>Y</enabled> </hop>
  <hop> <from>Count Def</from><to>ODS and Def</to><enabled>Y</enabled> </hop>
  <hop> <from>Count ODS</from><to>ODS and Def</to><enabled>Y</enabled> </hop>
  <hop> <from>Count Rows</from><to>def ods all</to><enabled>Y</enabled> </hop>
  <hop> <from>def ods all</from><to>Set Count Rec</to><enabled>Y</enabled> </hop>
  <hop> <from>ODS and Def</from><to>def ods all</to><enabled>Y</enabled> </hop>
  </order>
  <step>
    <name>Abort</name>
    <type>Abort</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <row_threshold>0</row_threshold>
      <message/>
      <always_log_rows>Y</always_log_rows>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>544</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Add def</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>      <jsScript>        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>&#xa;var timestamp_json&#xa;var name_json&#xa;var daypastdue_json&#xa;var record_json&#xa;&#xa;&#x2f;&#x2f; jezli nie ma def&#xa;&#xa;if &#x28; TIMESTAMP_DECISION_DEF &#x21;&#x3d; null&#x29; &#x7b;&#xa;     timestamp_json &#x3d; timestamp_json_s1 &#x2b; &#x27;,&#x27; &#x2b; TIMESTAMP_DECISION_DEF&#x3b;&#xa;&#x7d; else &#x7b;&#xa;     timestamp_json &#x3d; timestamp_json_s1&#x3b;&#xa;&#x7d;&#xa;&#xa;&#x2f;&#x2f; jezli nie ma def&#xa;&#xa;&#xa;if &#x28; NAME_DEF &#x21;&#x3d; null&#x29; &#x7b;&#xa;     name_json &#x3d; name_json_s1 &#x2b; &#x27;,&#x27; &#x2b; NAME_DEF&#x3b;&#xa;&#x7d; else &#x7b;&#xa;     name_json &#x3d; name_json_s1&#x3b;&#xa;&#x7d;&#xa;&#x2f;&#x2f; jezli nie ma jeszcze rat&#xa;&#xa;if &#x28; DAYPASTDUE_DEF &#x21;&#x3d; null&#x29; &#x7b;&#xa;     daypastdue_json &#x3d; daypastdue_json_s1 &#x2b; &#x27;,&#x27; &#x2b; DAYPASTDUE_DEF&#x3b;&#xa;&#x7d; else &#x7b;&#xa;     daypastdue_json &#x3d; daypastdue_json_s1&#x3b;&#xa;&#x7d;&#xa;&#x2f;&#x2f; jezli nie ma jeszcze rat&#xa;&#x2f;&#x2f; jezli nie ma jeszcze rat&#xa;&#xa;if &#x28; RECORD_TYPE_DEF &#x21;&#x3d; null&#x29; &#x7b;&#xa;     record_json &#x3d; record_json_s1 &#x2b; &#x27;,&#x27; &#x2b; RECORD_TYPE_DEF&#x3b;&#xa;&#x7d; else &#x7b;&#xa;     record_json &#x3d; record_json_s1&#x3b;&#xa;&#x7d;</jsScript_script>
      </jsScript>    </jsScripts>    <fields>      <field>        <name>timestamp_json</name>
        <rename>timestamp_json</rename>
        <type>String</type>
        <length>2000</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>      <field>        <name>name_json</name>
        <rename>name_json</rename>
        <type>String</type>
        <length>2000</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>      <field>        <name>daypastdue_json</name>
        <rename>daypastdue_json</rename>
        <type>String</type>
        <length>2000</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>      <field>        <name>record_json</name>
        <rename>record_json</rename>
        <type>String</type>
        <length>2000</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>544</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Count Def</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <all_rows>N</all_rows>
      <ignore_aggregate>N</ignore_aggregate>
      <field_ignore/>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>grp</prefix>
      <add_linenr>N</add_linenr>
      <linenr_fieldname/>
      <give_back_row>N</give_back_row>
      <group>
      </group>
      <fields>
        <field>
          <aggregate>COUNT_DEF</aggregate>
          <subject/>
          <type>COUNT_ANY</type>
          <valuefield/>
        </field>
      </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>752</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Count ODS</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <all_rows>N</all_rows>
      <ignore_aggregate>N</ignore_aggregate>
      <field_ignore/>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>grp</prefix>
      <add_linenr>N</add_linenr>
      <linenr_fieldname/>
      <give_back_row>N</give_back_row>
      <group>
      </group>
      <fields>
        <field>
          <aggregate>COUNT_ODS</aggregate>
          <subject/>
          <type>COUNT_ANY</type>
          <valuefield/>
        </field>
      </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>752</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Count Rows</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <all_rows>N</all_rows>
      <ignore_aggregate>N</ignore_aggregate>
      <field_ignore/>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>grp</prefix>
      <add_linenr>N</add_linenr>
      <linenr_fieldname/>
      <give_back_row>Y</give_back_row>
      <group>
      </group>
      <fields>
        <field>
          <aggregate>COUNT_INSERT</aggregate>
          <subject/>
          <type>COUNT_ANY</type>
          <valuefield/>
        </field>
      </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>544</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Create Arr JSON</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>      <jsScript>        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>&#x2f;&#x2f;Script here&#xa;&#xa;var timestamp_json_s1&#xa;var name_json_s1&#xa;var daypastdue_json_s1&#xa;var record_json_s1&#xa;var dueamount_json_s1&#xa;var record_num_events&#xa;var record_num_def&#xa;var record_num_zap&#xa;&#xa;if &#x28;NUMER_UMOWY_DEF &#x21;&#x3d;null&#x29;&#x7b;&#xa; record_num_def &#x3d; 1&#x3b;&#xa;&#x7d; else &#x7b;&#xa; record_num_def &#x3d; 0&#x3b;&#xa;&#x7d;&#xa;&#xa;if &#x28;NUMER_UMOWY_ZAP &#x21;&#x3d;null&#x29;&#x7b;&#xa; record_num_zap &#x3d; ROW_NUMBER_ZAP&#x3b;&#xa;&#x7d; else &#x7b;&#xa; record_num_zap &#x3d; 0&#x3b;&#xa;&#x7d;&#xa;&#xa;&#xa;record_num_events &#x3d; record_count_wn &#x2b; record_num_zap &#x2b; record_num_def&#xa;&#xa;&#x2f;&#x2f; jezli nie ma jeszcze rat&#xa;&#xa;if &#x28; DUEDATE_ZAP &#x21;&#x3d; null&#x29; &#x7b;&#xa;     timestamp_json_s1 &#x3d; TIMESTAMP_DECISION_WN &#x2b; &#x27;,&#x27; &#x2b; DUEDATE_ZAP&#x3b;&#xa;&#x7d; else &#x7b;&#xa;     timestamp_json_s1 &#x3d; TIMESTAMP_DECISION_WN&#x3b;&#xa;&#x7d;&#xa;&#xa;&#x2f;&#x2f; jezli nie ma jeszcze rat&#xa;&#xa;&#xa;if &#x28; NAME_ZAP &#x21;&#x3d; null&#x29; &#x7b;&#xa;     name_json_s1 &#x3d; NAME_WN &#x2b; &#x27;,&#x27; &#x2b; NAME_ZAP&#x3b;&#xa;&#x7d; else &#x7b;&#xa;     name_json_s1 &#x3d; NAME_WN&#x3b;&#xa;&#x7d;&#xa;&#x2f;&#x2f; jezli nie ma jeszcze rat&#xa;&#xa;if &#x28; DAYPASTDUE_ZAP &#x21;&#x3d; null&#x29; &#x7b;&#xa;     daypastdue_json_s1 &#x3d; DAYPASTDUE_WN &#x2b; &#x27;,&#x27; &#x2b; DAYPASTDUE_ZAP&#x3b;&#xa;&#x7d; else &#x7b;&#xa;     daypastdue_json_s1 &#x3d; DAYPASTDUE_WN&#x3b;&#xa;&#x7d;&#xa;&#x2f;&#x2f; jezli nie ma jeszcze rat&#xa;&#xa;if &#x28; RECORD_ZAP &#x21;&#x3d; null&#x29; &#x7b;&#xa;     record_json_s1 &#x3d; RECORD_TYPE_WN &#x2b; &#x27;,&#x27; &#x2b; RECORD_ZAP&#x3b;&#xa;&#x7d; else &#x7b;&#xa;     record_json_s1 &#x3d; RECORD_TYPE_WN&#x3b;&#xa;&#x7d;&#xa;&#xa;if &#x28; DUEAMOUNT_ZAP&#x21;&#x3d; null&#x29; &#x7b;&#xa;     dueamount_json_s1 &#x3d; DUEAMOUNT_WN &#x2b; &#x27;,&#x27; &#x2b; DUEAMOUNT_ZAP&#x3b;&#xa;&#x7d; else &#x7b;&#xa;     dueamount_json_s1 &#x3d; DUEAMOUNT_WN&#x3b;&#xa;&#x7d;&#xa;</jsScript_script>
      </jsScript>    </jsScripts>    <fields>      <field>        <name>timestamp_json_s1</name>
        <rename>timestamp_json_s1</rename>
        <type>String</type>
        <length>2000</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>      <field>        <name>name_json_s1</name>
        <rename>name_json_s1</rename>
        <type>String</type>
        <length>2000</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>      <field>        <name>daypastdue_json_s1</name>
        <rename>daypastdue_json_s1</rename>
        <type>String</type>
        <length>2000</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>      <field>        <name>record_json_s1</name>
        <rename>record_json_s1</rename>
        <type>String</type>
        <length>2000</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>      <field>        <name>dueamount_json_s1</name>
        <rename>dueamount_json_s1</rename>
        <type>String</type>
        <length>2000</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>      <field>        <name>record_num_events</name>
        <rename>record_num_events</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>752</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Create JSON</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>      <jsScript>        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>function findInArray&#x28;myValue, myArray&#x29;&#x7b;&#xa;	var myResult&#x3d;&#x27;&#x27;&#x3b;&#xa;	if&#x28;myArray.indexOf&#x28;myValue&#x29; &#x3e; -1&#x29;&#x7b;&#xa;		myResult &#x3d; true&#x3b;&#xa;	&#x7d; else &#x7b;&#xa;		myResult &#x3d; false&#x3b;&#xa;	&#x7d;&#xa;	return myResult&#x3b;&#xa;&#x7d;&#xa;&#xa;var json &#x3d; &#x7b;&#x7d;&#x3b;&#xa;&#xa;&#xa;&#x2f;&#x2f;  loans&#xa;json.appliedForPrincipalAmount &#x3d; APPLIEDFORPRINCIPALAMOUNT&#x3b;&#xa;json.currency &#x3d; CURRENCY&#x3b;&#xa;&#xa;if &#x28;LENDERLENDEEID &#x21;&#x3d;null&#x29; &#x7b;&#xa;json.lenderLendeeId &#x3d;LENDERLENDEEID&#x3b;&#xa;&#x7d;&#xa;json.lenderLoanApplicationId &#x3d; LENDERLOANAPPLICATIONID&#xa;&#xa;if &#x28;LENDERLOANID &#x21;&#x3d;null&#x29;   &#x7b;&#xa;json.lenderLoanId &#x3d; LENDERLOANID&#x3b;&#xa;&#x7d;&#xa;json.kontomatikSessionIds &#x3d; new Array&#x28;KONTOMATIKSESSIONIDS&#x29;&#xa;json.events &#x3d; &#x5b;&#x5d;&#x3b; &#xa;&#xa;&#x2f;&#x2f;  events&#xa;var v_name &#x3d; json_name.split&#x28;&#x27;,&#x27;&#x29;&#x3b;&#xa;var v_timestamp &#x3d; json_timestamp.split&#x28;&#x27;,&#x27;&#x29;&#x3b;&#xa;var v_daypastdue &#x3d; json_daypastdue.split&#x28;&#x27;,&#x27;&#x29;&#x3b;&#xa;var v_record_type &#x3d; json_record.split&#x28;&#x27;,&#x27;&#x29;&#x3b;&#xa;var v_amount &#x3d; json_dueamount.split&#x28;&#x27;,&#x27;&#x29;&#x3b;&#xa;&#xa;for&#x28;i&#x3d;0&#x3b; i&#x3c;json_events_count&#x3b; i&#x2b;&#x2b;&#x29;&#x7b;&#xa;	var colEvents &#x3d; &#x7b;&#x7d;&#x3b;&#xa;&#xa;	colEvents.name &#x3d;      String&#x28;v_name&#x5b;i&#x5d;&#x29;.trim&#x28;&#x29;&#x3b;&#xa;	colEvents.timestamp &#x3d; String&#x28;v_timestamp&#x5b;i&#x5d;&#x29;.trim&#x28;&#x29;&#x3b;&#xa;&#xa;if &#x28;v_record_type&#x5b;i&#x5d; &#x3d;&#x3d;2 &#x29; &#xa;&#x7b;&#xa;    colEvents.dayPastDue &#x3d; Number&#x28;v_daypastdue&#x5b;i&#x5d;&#x29;&#x3b;&#xa;&#x7d;&#xa;&#xa;&#xa;if &#x28;v_record_type&#x5b;i&#x5d; &#x3d;&#x3d;3 &#x29; &#xa;&#x7b;&#xa;    colEvents.amount     &#x3d; String&#x28;v_amount&#x5b;i&#x5d;&#x29;.trim&#x28;&#x29;&#x3b;&#xa;    colEvents.dayPastDue &#x3d; Number&#x28;v_daypastdue&#x5b;i&#x5d;&#x29;&#x3b;&#xa;&#x7d;&#xa;&#xa;&#xa;json.events.push&#x28;colEvents&#x29;&#x3b;&#xa;&#x7d;&#xa;&#xa;if &#x28;LENDERLOANID &#x21;&#x3d;null&#x29; &#x7b;&#xa;&#xa;    json.approvedPrincipalAmount &#x3d; APPROVEDPRINCIPALAMOUNT&#x3b;&#xa;    json.totalAmountDue &#x3d;json_totalAmountDue&#x3b;&#xa;&#x7d;&#xa;&#xa;&#xa;if &#x28;LENDERLOANID &#x21;&#x3d;null&#x29; &#x7b;&#xa;&#xa;var v_dueamount &#x3d; DUEAMOUNT.split&#x28;&#x27;,&#x27;&#x29;&#x3b;&#xa;var v_duedate &#x3d; DUEDATE.split&#x28;&#x27;,&#x27;&#x29;&#x3b;&#xa;&#xa;json.installments &#x3d; &#x5b;&#x5d;&#x3b;&#xa; &#xa;for&#x28;i&#x3d;0&#x3b; i&#x3c;ROW_NUMBER_RATY&#x3b; i&#x2b;&#x2b;&#x29;&#x7b;&#xa;	var colInstallments &#x3d; &#x7b;&#x7d;&#x3b;&#xa;	&#xa;	colInstallments.dueAmount &#x3d; String&#x28;v_dueamount&#x5b;i&#x5d;&#x29;.trim&#x28;&#x29;&#x3b;&#xa;	colInstallments.dueDate   &#x3d; String&#x28;v_duedate&#x5b;i&#x5d;&#x29;.trim&#x28;&#x29;&#x3b;&#xa;	json.installments.push&#x28;colInstallments&#x29;&#x3b;&#xa;&#x7d;&#xa;&#xa;&#x7d;	&#xa;myDocFinal &#x3d; JSON.stringify&#x28;json&#x29;&#x3b;&#xa;&#xa;&#xa;&#xa;</jsScript_script>
      </jsScript>    </jsScripts>    <fields>      <field>        <name>myDocFinal</name>
        <rename>myDocFinal</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>336</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Drop Column</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>      <field>        <name>APPLIEDFORPRINCIPALAMOUNT_WN</name>
        <rename>APPLIEDFORPRINCIPALAMOUNT</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>APPROVEDPRINCIPALAMOUNT_WN</name>
        <rename>APPROVEDPRINCIPALAMOUNT</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>CURRENCY_WN</name>
        <rename>CURRENCY</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>DUEAMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>DUEDATE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>KONTOMATIKSESSIONIDS_WN</name>
        <rename>KONTOMATIKSESSIONIDS</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>LENDERLENDEEID_WN</name>
        <rename>LENDERLENDEEID</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>LENDERLOANAPPLICATIONID_WN</name>
        <rename>LENDERLOANAPPLICATIONID</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>LENDERLOANID_WN</name>
        <rename>LENDERLOANID</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>NAME_WN</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>ROW_NUMBER_RATY</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TIMESTAMP_DECISION_WN</name>
        <rename>TIMESTAMP_DECISION</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>daypastdue_json</name>
        <rename>json_daypastdue</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>dueamount_json_s1</name>
        <rename>json_dueamount</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>name_json</name>
        <rename>json_name</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>record_json</name>
        <rename>json_record</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>record_num_events</name>
        <rename>json_events_count</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>timestamp_json</name>
        <rename>json_timestamp</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>totalAmountDue</name>
        <rename>json_totalAmountDue</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFRESH_DATE_WN</name>
        <rename>REFRESH_DATE</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>NUMER_WNIOSKU_WN</name>
        <rename>NUMER_WNIOSKU</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>NUMER_UMOWY_WN</name>
        <rename>NUMER_UMOWY</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>DEFAULTED_STATUS_DEF</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>ODS_STAT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>        <select_unspecified>N</select_unspecified>
    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>336</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Dummy Filtr</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>672</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Filter rows 2</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<send_true_to/>
<send_false_to/>
    <compare>
<condition>
 <negated>N</negated>
 <leftvalue>KWOTA_OTWARTA</leftvalue>
 <function>&#x3c;&#x3d;</function>
 <rightvalue/>
 <value><name>constant</name><type>Number</type><text>5.0</text><length>-1</length><precision>-1</precision><isnull>N</isnull><mask>&#x23;.&#x23;</mask></value> </condition>
    </compare>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>32</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Get All WN</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>DWH - oper</connection>
    <sql>select &#x2a; from &#x28;SELECT &#xd;&#xa;    um.numer                  AS numer_umowy_wn ,&#xd;&#xa;    www.identyfikator_wniosku AS numer_wniosku_wn ,&#xd;&#xa;    www.id_wniosku            AS id_wniosku_wn ,&#xd;&#xa;    www.kwota_wnioskowana     AS appliedforprincipalamount_wn ,&#xd;&#xa;    www.id_wniosku            AS lenderloanapplicationid_wn ,&#xd;&#xa;    &#x27;PLN&#x27;                     AS currency_wn ,&#xd;&#xa;    kontomatik_session_id     AS kontomatiksessionids_wn ,&#xd;&#xa;    TO_CHAR&#x28;stat.ts,&#x27;YYYY-MM-DD&#x27;&#x29; AS timestamp_decision_wn ,&#xd;&#xa;    stat.ts                   AS timestamp_decision_order, &#xd;&#xa;    um.kwota_kapitalu         AS approvedPrincipalAmount_wn ,&#xd;&#xa;    um.klient_id              AS lenderlendeeid_wn ,&#xd;&#xa;    SUBSTR&#x28;um.numer,9,8&#x29;      AS lenderloanid_wn ,&#xd;&#xa;    CASE&#xd;&#xa;      WHEN stat.nowy_kod IN &#x28;&#x27;UXT&#x27;,&#x27;UX&#x27;,&#x27;ODR&#x27;,&#x27;ABZ&#x27;,&#x27;ANU&#x27;,&#x27;ATR&#x27;,&#x27;ODW&#x27;,&#x27;ORW&#x27;&#x29;&#xd;&#xa;      THEN &#x27;rejected&#x27;&#xd;&#xa;      WHEN stat.nowy_kod &#x3d; &#x27;ZRW&#x27;&#xd;&#xa;      THEN &#x27;approved&#x27;&#xd;&#xa;      WHEN stat.nowy_kod &#x3d; &#x27;WAW&#x27;&#xd;&#xa;      THEN &#x27;applied&#x27;&#xd;&#xa;      WHEN stat.nowy_kod &#x3d; &#x27;ODS&#x27;&#xd;&#xa;      THEN &#x27;cancelled&#x27;&#xd;&#xa;    END     AS name_wn ,&#xd;&#xa;    -99     AS daypastdue_wn ,&#xd;&#xa;    1       AS record_type_wn ,&#xd;&#xa;    0       AS dueamount_wn ,&#xd;&#xa;    sysdate AS refresh_date_wn ,&#xd;&#xa;    0       AS ods_stat,&#xd;&#xa;    stat.order_col as order_col_wn&#xd;&#xa;  FROM oper.t_kon_temp www&#xd;&#xa;    -- wnioski&#xd;&#xa;  INNER JOIN axcess.t_wnioski_all wn&#xd;&#xa;  ON www.identyfikator_wniosku &#x3d; wn.identyfikator&#xd;&#xa;    -- umowy&#xd;&#xa;  LEFT JOIN sys_kredyty.v_ax_umowy&#x40;berberys_ara_st um&#xd;&#xa;  ON wn.umowa_id &#x3d; um.numer&#xd;&#xa;    -- statusy wniosk&#xf3;w&#xd;&#xa;  INNER JOIN&#xd;&#xa;    &#x28;SELECT nowy_kod,&#xd;&#xa;      nr_wniosku,&#xd;&#xa;      MIN&#x28;ts&#x29; ts,&#xd;&#xa;      1 as order_col&#xd;&#xa;    FROM sys_credit.v_api_historia_statusow&#x40;berberys_st&#xd;&#xa;    INNER JOIN oper.t_kon_temp&#xd;&#xa;    ON identyfikator_wniosku &#x3d; nr_wniosku&#xd;&#xa;    WHERE nowy_kod  IN &#x28;&#x27;WAW&#x27;&#x29;&#xd;&#xa;    GROUP BY nowy_kod,&#xd;&#xa;      nr_wniosku,&#xd;&#xa;      1&#xd;&#xa;    UNION ALL&#xd;&#xa;    SELECT nowy_kod,&#xd;&#xa;      nr_wniosku,&#xd;&#xa;      MAX&#x28;ts&#x29; ts,&#xd;&#xa;      2 as order_col&#xd;&#xa;    FROM sys_credit.v_api_historia_statusow&#x40;berberys_st&#xd;&#xa;    INNER JOIN oper.t_kon_temp&#xd;&#xa;    ON identyfikator_wniosku &#x3d; nr_wniosku&#xd;&#xa;    WHERE nowy_kod  IN &#x28;&#x27;UXT&#x27;,&#x27;UX&#x27;,&#x27;ODR&#x27;,&#x27;ABZ&#x27;,&#x27;ANU&#x27;,&#x27;ATR&#x27;,&#x27;ODW&#x27;,&#x27;ORW&#x27;,&#x27;ZRW&#x27;&#x29;&#xd;&#xa;    GROUP BY nowy_kod, nr_wniosku, 3&#xd;&#xa;    &#x29; stat ON www.identyfikator_wniosku &#x3d; stat.nr_wniosku&#xd;&#xa;  LEFT JOIN oper.t_kon_defaulted defo&#xd;&#xa;  ON defo.numer_umowy &#x3d; um.numer&#xd;&#xa;  where defo.numer_umowy is null&#xd;&#xa;  UNION ALL&#xd;&#xa;  select &#xd;&#xa;     um.numer                               as numer_umowy&#xd;&#xa;    ,temp.identyfikator_wniosku             as numer_wniosku&#xd;&#xa;    ,temp.id_wniosku                        as id_wniosku&#xd;&#xa;    ,temp.kwota_wnioskowana                 as appliedforprincipalamount&#xd;&#xa;    ,temp.id_wniosku                        as lenderLoanApplicationId&#xd;&#xa;    ,&#x27;PLN&#x27;                                  as currency&#xd;&#xa;    ,temp.kontomatik_session_id             as kontomatikSessionIds&#xd;&#xa;    ,to_char&#x28;um.data_wyplaty,&#x27;YYYY-MM-DD&#x27;&#x29;  as dueDate_rat&#xd;&#xa;    ,um.data_wyplaty                        as dueDate_order&#xd;&#xa;    ,um.kwota_kapitalu                      as approvedPrincipalAmount&#xd;&#xa;    ,um.klient_id                           as lenderLendeeId&#xd;&#xa;    ,SUBSTR&#x28;um.numer,9,8&#x29;                   as lenderLoanId&#xd;&#xa;    ,&#x27;repaid&#x27;                               as name_wn&#xd;&#xa;    ,0                                      as dayPastDue_rat&#xd;&#xa;    ,3                                      as record_zap    &#xd;&#xa;    ,round&#x28;um.kwota_kapitalu &#x2a; 0.25,2&#x29;      as dueAmount_rat&#xd;&#xa; -- ,1                                      as row_number_zap&#xd;&#xa;    ,sysdate                                as refresh_date&#xd;&#xa;    ,0                                      as ods_stat&#xd;&#xa;    ,3                                      as order_col&#xd;&#xa;from sys_kredyty.v_ax_umowy&#x40;berberys_ara_st um&#xd;&#xa;           inner join oper.t_kon_temp       temp&#xd;&#xa;                 on substr&#x28;um.numer,9,8&#x29; &#x3d; temp.id_wniosku&#xd;&#xa;           left join oper.t_kon_defaulted defo&#xd;&#xa;                 on defo.numer_umowy &#x3d; um.numer&#xd;&#xa;     where produkt_kod like &#x27;&#x25;UPFR&#x25;&#x25;&#x27; and defo.numer_umowy is null&#xd;&#xa;union all&#xd;&#xa;SELECT &#xd;&#xa;    um.numer                  AS numer_umowy_wn ,&#xd;&#xa;    www.identyfikator_wniosku AS numer_wniosku_wn ,&#xd;&#xa;    www.id_wniosku            AS id_wniosku_wn ,&#xd;&#xa;    www.kwota_wnioskowana     AS appliedforprincipalamount_wn ,&#xd;&#xa;    www.id_wniosku            AS lenderloanapplicationid_wn ,&#xd;&#xa;    &#x27;PLN&#x27;                     AS currency_wn ,&#xd;&#xa;    kontomatik_session_id     AS kontomatiksessionids_wn ,&#xd;&#xa;    TO_CHAR&#x28;stat.ts,&#x27;YYYY-MM-DD&#x27;&#x29; AS timestamp_decision_wn ,&#xd;&#xa;    stat.ts                   AS timestamp_decision_order, &#xd;&#xa;    um.kwota_kapitalu         AS approvedPrincipalAmount_wn ,&#xd;&#xa;    um.klient_id              AS lenderlendeeid_wn ,&#xd;&#xa;    SUBSTR&#x28;um.numer,9,8&#x29;      AS lenderloanid_wn ,&#xd;&#xa;   &#x27;cancelled&#x27;                  AS name_wn ,&#xd;&#xa;    -99     AS daypastdue_wn ,&#xd;&#xa;    1       AS record_type_wn ,&#xd;&#xa;    0       AS dueamount_wn ,&#xd;&#xa;    sysdate AS refresh_date_wn ,&#xd;&#xa;    1       AS ods_stat,&#xd;&#xa;    stat.order_col as order_col_wn&#xd;&#xa;  FROM oper.t_kon_temp www&#xd;&#xa;    -- wnioski&#xd;&#xa;  INNER JOIN axcess.t_wnioski_all wn&#xd;&#xa;  ON www.identyfikator_wniosku &#x3d; wn.identyfikator&#xd;&#xa;    -- umowy&#xd;&#xa;  LEFT JOIN sys_kredyty.v_ax_umowy&#x40;berberys_ara_st um&#xd;&#xa;  ON wn.umowa_id &#x3d; um.numer&#xd;&#xa;    -- statusy wniosk&#xf3;w&#xd;&#xa;  INNER JOIN&#xd;&#xa;    &#x28;SELECT nowy_kod,&#xd;&#xa;      nr_wniosku,&#xd;&#xa;      MIN&#x28;ts&#x29; ts,&#xd;&#xa;      4 as order_col&#xd;&#xa;    FROM sys_credit.v_api_historia_statusow&#x40;berberys_st&#xd;&#xa;    INNER JOIN oper.t_kon_temp&#xd;&#xa;    ON identyfikator_wniosku &#x3d; nr_wniosku&#xd;&#xa;    WHERE nowy_kod  IN &#x28;&#x27;ODS&#x27;&#x29;&#xd;&#xa;    GROUP BY nowy_kod,&#xd;&#xa;      nr_wniosku,&#xd;&#xa;      4&#x29; stat&#xd;&#xa;  ON www.identyfikator_wniosku &#x3d; stat.nr_wniosku&#xd;&#xa;  LEFT JOIN oper.t_kon_defaulted defo&#xd;&#xa;  ON defo.numer_umowy &#x3d; um.numer&#xd;&#xa;  where defo.numer_umowy is null      &#x29;sub&#xd;&#xa;    order by sub.numer_wniosku_wn asc, sub.order_col_wn asc&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>32</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Get Def</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>DWH - oper</connection>
    <sql>select &#xd;&#xa;    um.numer                                                      AS numer_umowy_def ,&#xd;&#xa;    temp.identyfikator_wniosku                                    AS numer_wniosku_def ,&#xd;&#xa;    temp.id_wniosku                                               AS id_wniosku_def ,&#xd;&#xa;    temp.kwota_wnioskowana                                        AS appliedforprincipalamount_def ,&#xd;&#xa;    temp.id_wniosku                                               AS lenderLoanApplicationId_def ,&#xd;&#xa;    &#x27;PLN&#x27;                                                         AS currency_def ,&#xd;&#xa;    kontomatik_session_id                                         AS kontomatikSessionIds_def ,&#xd;&#xa;    case when stat.ts &#x3c; raty.data_def&#x2b;70 &#xd;&#xa;         then to_char&#x28;stat.ts,&#x27;yyyy-mm-dd&#x27;&#x29; else to_char&#x28;raty.data_def&#x2b;70,&#x27;yyyy-mm-dd&#x27;&#x29;&#xd;&#xa;         end                                                      AS timestamp_decision_def ,&#xd;&#xa;    um.kwota_kapitalu                                             AS approvedPrincipalAmount_def ,&#xd;&#xa;    um.klient_id                                                  AS lenderLendeeId_def ,&#xd;&#xa;    SUBSTR&#x28;um.numer,9,8&#x29;                                          AS lenderLoanId_def ,&#xd;&#xa;    &#x27;defaulted&#x27;                                                   AS name_def ,&#xd;&#xa;    case when stat.ts &#x3c; raty.data_def&#x2b;70&#xd;&#xa;         then round&#x28;trunc&#x28;stat.ts&#x29;- trunc&#x28;raty.data_def&#x29;,0&#x29; else 70&#xd;&#xa;    end                                                            AS daypastdue_def ,&#xd;&#xa;    2                                                             AS record_type_def ,&#xd;&#xa;    0                                                             AS dueamount_def ,&#xd;&#xa;    sysdate                                                       AS refresh_date_def ,&#xd;&#xa;    1                                                             AS defaulted_status_def &#xd;&#xa;from oper.t_kon_temp temp&#xd;&#xa;     inner join sys_kredyty.v_ax_umowy&#x40;berberys_ara_st um&#xd;&#xa;on temp.numer_umowy &#x3d; um.numer&#xd;&#xa;     inner join&#xd;&#xa;    &#x28;select min&#x28;data&#x29; as data_def,kredyt_id from  sys_kredyty.v_ax_raty&#x40;berberys_ara_st rat&#xd;&#xa;         inner join  sys_kredyty.v_ax_harmonogramy&#x40;berberys_ara_st    har&#xd;&#xa;     on har.id &#x3d; rat.harm_id  &#xd;&#xa;            where rat.status_kod &#x3d; &#x27;Z&#x27; and har.status_kod &#x3d; &#x27;A&#x27; and data_splaty is null&#xd;&#xa;    group by kredyt_id&#x29; raty&#xd;&#xa;on  um.id &#x3d; raty.kredyt_id&#xd;&#xa;    left join&#xd;&#xa;    &#x28;select &#xd;&#xa;      nr_wniosku,&#xd;&#xa;      min&#x28;ts&#x29; ts&#xd;&#xa;    from sys_credit.v_api_historia_statusow&#x40;berberys_st&#xd;&#xa;    inner join oper.t_kon_temp&#xd;&#xa;    on identyfikator_wniosku &#x3d; nr_wniosku&#xd;&#xa;    where nowy_kod in &#x28;&#x27;UZS&#x27;,&#x27;UZN&#x27;&#x29;&#xd;&#xa;    group by  nr_wniosku&#xd;&#xa;    &#x29; stat&#xd;&#xa;on temp.identyfikator_wniosku &#x3d; stat.nr_wniosku&#xd;&#xa;  left join oper.t_kon_defaulted defo&#xd;&#xa;  on defo.numer_umowy &#x3d; um.numer&#xd;&#xa;where um.produkt_kod LIKE &#x27;&#x25;RAT&#x25;&#x27; and um.status IN &#x28;&#x27;UZS&#x27;,&#x27;UZN&#x27;&#x29; and  defo.numer_umowy is null&#xd;&#xa;&#xd;&#xa;union all&#xd;&#xa;&#xd;&#xa;select &#xd;&#xa;    um.numer                                                      AS numer_umowy_def ,&#xd;&#xa;    temp.identyfikator_wniosku                                    AS numer_wniosku_def ,&#xd;&#xa;    temp.id_wniosku                                               AS id_wniosku_def ,&#xd;&#xa;    temp.kwota_wnioskowana                                        AS appliedforprincipalamount_def ,&#xd;&#xa;    temp.id_wniosku                                               AS lenderLoanApplicationId_def ,&#xd;&#xa;    &#x27;PLN&#x27;                                                         AS currency_def ,&#xd;&#xa;    kontomatik_session_id                                         AS kontomatikSessionIds_def ,&#xd;&#xa;    case when stat.ts &#x3c; raty.data_def&#x2b;55 &#xd;&#xa;         then to_char&#x28;stat.ts,&#x27;yyyy-mm-dd&#x27;&#x29; else to_char&#x28;raty.data_def&#x2b;55,&#x27;yyyy-mm-dd&#x27;&#x29;&#xd;&#xa;         end                                                      AS timestamp_decision_def ,&#xd;&#xa;    um.kwota_kapitalu                                             AS approvedPrincipalAmount_def ,&#xd;&#xa;    um.klient_id                                                  AS lenderLendeeId_def ,&#xd;&#xa;    SUBSTR&#x28;um.numer,9,8&#x29;                                          AS lenderLoanId_def ,&#xd;&#xa;    &#x27;defaulted&#x27;                                                   AS name_def ,&#xd;&#xa;    case when stat.ts &#x3c; raty.data_def&#x2b;55&#xd;&#xa;         then round&#x28;trunc&#x28;stat.ts&#x29;- trunc&#x28;raty.data_def&#x29;,0&#x29; else 55&#xd;&#xa;    end                                                           AS daypastdue_def ,&#xd;&#xa;    2                                                             AS record_type_def ,&#xd;&#xa;    0                                                             AS dueamount_def ,&#xd;&#xa;    sysdate                                                       AS refresh_date_def ,&#xd;&#xa;    1                                                             AS defaulted_status_def &#xd;&#xa;from oper.t_kon_temp temp&#xd;&#xa;     inner join sys_kredyty.v_ax_umowy&#x40;berberys_ara_st um&#xd;&#xa;on temp.numer_umowy &#x3d; um.numer&#xd;&#xa;     inner join&#xd;&#xa;    &#x28;select min&#x28;data&#x29; as data_def,kredyt_id from  sys_kredyty.v_ax_raty&#x40;berberys_ara_st rat&#xd;&#xa;         inner join  sys_kredyty.v_ax_harmonogramy&#x40;berberys_ara_st    har&#xd;&#xa;     on har.id &#x3d; rat.harm_id  &#xd;&#xa;            where rat.status_kod &#x3d; &#x27;Z&#x27; and har.status_kod &#x3d; &#x27;A&#x27; and data_splaty is null&#xd;&#xa;    group by kredyt_id&#x29; raty&#xd;&#xa;on  um.id &#x3d; raty.kredyt_id&#xd;&#xa;    left join&#xd;&#xa;    &#x28;select &#xd;&#xa;      nr_wniosku,&#xd;&#xa;      min&#x28;ts&#x29; ts &#xd;&#xa;    from sys_credit.v_api_historia_statusow&#x40;berberys_st&#xd;&#xa;    inner join oper.t_kon_temp&#xd;&#xa;    on identyfikator_wniosku &#x3d; nr_wniosku&#xd;&#xa;    where nowy_kod in &#x28;&#x27;UZS&#x27;,&#x27;UZN&#x27;&#x29;&#xd;&#xa;    group by  nr_wniosku&#xd;&#xa;    &#x29; stat&#xd;&#xa;on temp.identyfikator_wniosku &#x3d; stat.nr_wniosku&#xd;&#xa;  left join oper.t_kon_defaulted defo&#xd;&#xa;  on defo.numer_umowy &#x3d; um.numer&#xd;&#xa;where um.produkt_kod NOT LIKE &#x27;&#x25;RAT&#x25;&#x27; and um.status IN &#x28;&#x27;UZS&#x27;,&#x27;UZN&#x27;&#x29; and  defo.numer_umowy is null&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>336</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Group by raty</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <all_rows>N</all_rows>
      <ignore_aggregate>N</ignore_aggregate>
      <field_ignore/>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>grp</prefix>
      <add_linenr>N</add_linenr>
      <linenr_fieldname/>
      <give_back_row>N</give_back_row>
      <group>
        <field>
          <name>NUMER_UMOWY_RAT</name>
        </field>
      </group>
      <fields>
        <field>
          <aggregate>DUEAMOUNT</aggregate>
          <subject>DUEAMOUNT_RAT</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>DUEDATE</aggregate>
          <subject>DUEDATE_RAT</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>DAYPASTDUE</aggregate>
          <subject>DAYPASTDUE_RAT</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>ROW_NUMBER_RATY</aggregate>
          <subject>ROW_NUMBER_RAT</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>totalAmountDue</aggregate>
          <subject>DUEAMOUNT_RAT</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>NUMER_RATY</aggregate>
          <subject>NUMER_RAT</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
      </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>32</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Group by wnioski</name>
    <type>GroupBy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <all_rows>N</all_rows>
      <ignore_aggregate>N</ignore_aggregate>
      <field_ignore/>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>grp</prefix>
      <add_linenr>N</add_linenr>
      <linenr_fieldname/>
      <give_back_row>N</give_back_row>
      <group>
        <field>
          <name>NUMER_WNIOSKU_WN</name>
        </field>
      </group>
      <fields>
        <field>
          <aggregate>APPLIEDFORPRINCIPALAMOUNT_WN</aggregate>
          <subject>APPLIEDFORPRINCIPALAMOUNT_WN</subject>
          <type>FIRST_INCL_NULL</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>LENDERLOANAPPLICATIONID_WN</aggregate>
          <subject>LENDERLOANAPPLICATIONID_WN</subject>
          <type>FIRST_INCL_NULL</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>CURRENCY_WN</aggregate>
          <subject>CURRENCY_WN</subject>
          <type>FIRST_INCL_NULL</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>APPROVEDPRINCIPALAMOUNT_WN</aggregate>
          <subject>APPROVEDPRINCIPALAMOUNT_WN</subject>
          <type>FIRST_INCL_NULL</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>LENDERLENDEEID_WN</aggregate>
          <subject>LENDERLENDEEID_WN</subject>
          <type>FIRST_INCL_NULL</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>LENDERLOANID_WN</aggregate>
          <subject>LENDERLOANID_WN</subject>
          <type>FIRST_INCL_NULL</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>KONTOMATIKSESSIONIDS_WN</aggregate>
          <subject>KONTOMATIKSESSIONIDS_WN</subject>
          <type>FIRST_INCL_NULL</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>REFRESH_DATE_WN</aggregate>
          <subject>REFRESH_DATE_WN</subject>
          <type>FIRST_INCL_NULL</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>NUMER_UMOWY_WN</aggregate>
          <subject>NUMER_UMOWY_WN</subject>
          <type>FIRST_INCL_NULL</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>TIMESTAMP_DECISION_WN</aggregate>
          <subject>TIMESTAMP_DECISION_WN</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>NAME_WN</aggregate>
          <subject>NAME_WN</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>DAYPASTDUE_WN</aggregate>
          <subject>DAYPASTDUE_WN</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>RECORD_TYPE_WN</aggregate>
          <subject>RECORD_TYPE_WN</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>DUEAMOUNT_WN</aggregate>
          <subject>DUEAMOUNT_WN</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>record_count_wn</aggregate>
          <subject/>
          <type>COUNT_ANY</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>ODS_STAT</aggregate>
          <subject>ODS_STAT</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
      </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>128</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Insert Data</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>DWH</connection>
    <schema>OPER</schema>
    <table>T_KON_HIST</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>MYDOCFINAL</column_name>
          <stream_name>myDocFinal</stream_name>
        </field>
        <field>
          <column_name>NUMER_WNIOSKU</column_name>
          <stream_name>NUMER_WNIOSKU</stream_name>
        </field>
        <field>
          <column_name>REFRESH_DATE</column_name>
          <stream_name>REFRESH_DATE</stream_name>
        </field>
        <field>
          <column_name>DEFAULTED_STATUS</column_name>
          <stream_name>DEFAULTED_STATUS_DEF</stream_name>
        </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>336</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Insert Defaulted</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>DWH</connection>
    <schema>OPER</schema>
    <table>t_kon_defaulted</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>NUMER_UMOWY</column_name>
          <stream_name>NUMER_UMOWY</stream_name>
        </field>
        <field>
          <column_name>STATUS</column_name>
          <stream_name>DEFAULTED_STATUS_DEF</stream_name>
        </field>
        <field>
          <column_name>INSERT_DATE</column_name>
          <stream_name>REFRESH_DATE</stream_name>
        </field>
        <field>
          <column_name>NUMER_WNIOSKU</column_name>
          <stream_name>NUMER_WNIOSKU</stream_name>
        </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>672</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Insert ODS</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>DWH</connection>
    <schema>OPER</schema>
    <table>t_kon_ods</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>NUMER_UMOWY</column_name>
          <stream_name>NUMER_UMOWY</stream_name>
        </field>
        <field>
          <column_name>STATUS</column_name>
          <stream_name>DEFAULTED_STATUS_DEF</stream_name>
        </field>
        <field>
          <column_name>INSERT_DATE</column_name>
          <stream_name>REFRESH_DATE</stream_name>
        </field>
        <field>
          <column_name>NUMER_WNIOSKU</column_name>
          <stream_name>NUMER_WNIOSKU</stream_name>
        </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>672</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Merge Def</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<join_type>LEFT OUTER</join_type>
<step1>Sort rows 2</step1>
<step2>Sort rows</step2>
    <keys_1>
      <key>NUMER_UMOWY_WN</key>
    </keys_1>
    <keys_2>
      <key>NUMER_UMOWY_DEF</key>
    </keys_2>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>544</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Merge REPAID</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<join_type>LEFT OUTER</join_type>
<step1>Sort rows 3</step1>
<step2>Sort by wniosek</step2>
    <keys_1>
      <key>NUMER_UMOWY_WN</key>
    </keys_1>
    <keys_2>
      <key>NUMER_UMOWY_ZAP</key>
    </keys_2>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>ODS and Def</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<join_type>FULL OUTER</join_type>
<step1>Count Def</step1>
<step2>Count ODS</step2>
    <keys_1>
    </keys_1>
    <keys_2>
    </keys_2>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>864</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Raty</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>DWH</connection>
    <sql>select &#x2a; from &#x28;&#xa;select &#xa;     um.numer                               as numer_umowy_rat&#xa;    ,round&#x28;um.kwota_kapitalu &#x2a; 0.25,2&#x29;      as dueAmount_rat&#xa;    ,to_char&#x28;um.data_wyplaty,&#x27;YYYY-MM-DD&#x27;&#x29;  as dueDate_rat&#xa;    ,to_number&#x28;0&#x29;                           as dayPastDue_rat&#xa;    ,1                                      as row_number_rat&#xa;    ,0                                      as numer_rat&#xa;from sys_kredyty.v_ax_umowy&#x40;berberys_ara_st um&#xa;           inner join oper.t_kon_temp       temp&#xa;                 on substr&#x28;um.numer,9,8&#x29; &#x3d; temp.id_wniosku&#xa;           left join oper.t_kon_defaulted defo&#xa;                 on defo.numer_umowy &#x3d; um.numer&#xa;     where produkt_kod like &#x27;&#x25;UPFR&#x25;&#x25;&#x27; and defo.numer_umowy is null     &#xa;UNION ALL&#xa;select  &#xa;    um.numer                               as numer_umowy&#xa;   ,nvl&#x28;rat.kapital,0&#x29; &#x2b;&#xa;    nvl&#x28;rat.prowizja_za_udziel,0&#x29; &#x2b;&#xa;    nvl&#x28;rat.prowizja_za_wypl,0&#x29; &#x2b;&#xa;    nvl&#x28;rat.prowizja_za_serwis,0&#x29; &#x2b;&#xa;    nvl&#x28;rat.odsetki,0&#x29;                     as dueAmount_rat&#xa;   ,to_char&#x28;rat.data,&#x27;YYYY-MM-DD&#x27;&#x29;         as dueDate_rat&#xa;   ,to_number&#x28;nvl&#x28;rat.dpd,0&#x29;&#x29;              as dayPastDue_rat&#xa;   ,1                                      as row_number_raty&#xa;   ,rat.numer                              as numer_raty&#xa;from &#xa;           sys_kredyty.v_ax_harmonogramy&#x40;berberys_ara_st har &#xa;           inner join sys_kredyty.v_ax_raty&#x40;berberys_ara_st rat&#xa;              on har.id &#x3d; rat.harm_id&#xa;           left join sys_kredyty.v_ax_umowy&#x40;berberys_ara_st um&#xa;              on har.kredyt_id &#x3d; um.id&#xa;           inner join oper.t_kon_temp  temp&#xa;              on substr&#x28;um.numer,9,8&#x29; &#x3d; temp.id_wniosku&#xa;           left join oper.t_kon_defaulted defo&#xa;                 on defo.numer_umowy &#x3d; um.numer&#xa;           where  har.status_kod &#x3d; &#x27;A&#x27; and defo.numer_umowy is null &#x29;sub&#xa;order by sub.numer_umowy_rat asc, sub.numer_rat asc</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>32</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Raty Zapad&#x142;e</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <all_rows>N</all_rows>
      <ignore_aggregate>N</ignore_aggregate>
      <field_ignore/>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>grp</prefix>
      <add_linenr>N</add_linenr>
      <linenr_fieldname/>
      <give_back_row>N</give_back_row>
      <group>
        <field>
          <name>NUMER_UMOWY_ZAP</name>
        </field>
      </group>
      <fields>
        <field>
          <aggregate>DUEAMOUNT_ZAP</aggregate>
          <subject>DUEAMOUNT_ZAP</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>DUEDATE_ZAP</aggregate>
          <subject>DUEDATE_ZAP</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>DAYPASTDUE_ZAP</aggregate>
          <subject>DAYPASTDUE_ZAP</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>NAME_ZAP</aggregate>
          <subject>NAME_ZAP</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>RECORD_ZAP</aggregate>
          <subject>RECORD_ZAP</subject>
          <type>CONCAT_COMMA</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>ROW_NUMBER_ZAP</aggregate>
          <subject>ROW_NUMBER_ZAP</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
      </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>32</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Raty Zapad&#x142;e data</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>DWH</connection>
    <sql>SELECT &#x2a; from &#x28;Select &#xd;&#xa;    um.numer           as numer_umowy_zap&#xd;&#xa;   ,temp.id_wniosku    as numer_wniosku_zap&#xd;&#xa;   ,nvl&#x28;rat.kapital,0&#x29; &#x2b;&#xd;&#xa;    nvl&#x28;rat.prowizja_za_udziel,0&#x29; &#x2b;&#xd;&#xa;    nvl&#x28;rat.prowizja_za_wypl,0&#x29; &#x2b;&#xd;&#xa;    nvl&#x28;rat.prowizja_za_serwis,0&#x29; &#x2b;&#xd;&#xa;    nvl&#x28;rat.odsetki,0&#x29; as dueAmount_zap&#xd;&#xa;   ,to_char&#x28;rat.data_splaty,&#x27;YYYY-MM-DD&#x27;&#x29;  &#xd;&#xa;                       as dueDate_zap&#xd;&#xa;   ,case when rat.dpd &#x3c; 0 then &#x27;0&#x27; else rat.dpd&#xd;&#xa;                   end as dayPastDue_zap&#xd;&#xa;   ,&#x27;repaid&#x27;           as name_zap&#xd;&#xa;   ,3                  as record_zap&#xd;&#xa;   ,1                  as row_number_zap&#xd;&#xa;   ,rat.kwota_otwarta&#xd;&#xa;from oper.t_kon_temp temp&#xd;&#xa;inner join sys_kredyty.v_ax_umowy&#x40;berberys_ara_st um&#xd;&#xa;on temp.numer_umowy &#x3d; um.numer&#xd;&#xa;inner join  sys_kredyty.v_ax_harmonogramy&#x40;berberys_ara_st har &#xd;&#xa;on har.kredyt_id &#x3d; um.id&#xd;&#xa;inner join sys_kredyty.v_ax_raty&#x40;berberys_ara_st rat&#xd;&#xa;on har.id &#x3d; rat.harm_id&#xd;&#xa;left join &#x28;&#xd;&#xa;  SELECT nowy_kod,&#xd;&#xa;      nr_wniosku,&#xd;&#xa;      MIN&#x28;ts&#x29; ts,&#xd;&#xa;      4 as order_col&#xd;&#xa;    FROM sys_credit.v_api_historia_statusow&#x40;berberys_st&#xd;&#xa;    INNER JOIN oper.t_kon_temp&#xd;&#xa;    ON identyfikator_wniosku &#x3d; nr_wniosku&#xd;&#xa;    WHERE nowy_kod  IN &#x28;&#x27;ODS&#x27;&#x29;&#xd;&#xa;    GROUP BY nowy_kod,&#xd;&#xa;      nr_wniosku,&#xd;&#xa;      4&#x29; stat&#xd;&#xa;  ON identyfikator_wniosku &#x3d; stat.nr_wniosku&#xd;&#xa;where  har.status_kod &#x3d; &#x27;A&#x27;  and rat.data_splaty is not null and stat.nr_wniosku is null&#xd;&#xa;  and rat.data_splaty  &#x3c;&#x3d; trunc&#x28;last_day&#x28;add_months&#x28;sysdate,-1&#x29;&#x29;&#x29;&#x29;sub&#xd;&#xa;order by sub.numer_umowy_zap, sub.dueDate_zap&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>      <field>        <name>myDocFinal</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>NUMER_WNIOSKU</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFRESH_DATE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>NUMER_UMOWY</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>DEFAULTED_STATUS_DEF</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>ODS_STAT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>        <select_unspecified>N</select_unspecified>
      <meta>        <name>REFRESH_DATE</name>
        <rename>REFRESH_DATE</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd HH&#x3a;mm&#x3a;ss</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>336</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Set Count Rec</name>
    <type>SetVariable</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>
      <field>
        <field_name>COUNT_INSERT</field_name>
        <variable_name>V_COUNT_INSERT</variable_name>
        <variable_type>JVM</variable_type>
        <default_value>0</default_value>
        </field>
      <field>
        <field_name>COUNT_DEF</field_name>
        <variable_name>V_COUNT_DEF</variable_name>
        <variable_type>JVM</variable_type>
        <default_value>0</default_value>
        </field>
      <field>
        <field_name>COUNT_ODS</field_name>
        <variable_name>V_COUNT_ODS</variable_name>
        <variable_type>JVM</variable_type>
        <default_value>0</default_value>
        </field>
      </fields>
    <use_formatting>Y</use_formatting>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>864</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Sort Nr Umowy</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>NUMER_UMOWY_WN</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <presorted>N</presorted>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>16</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Sort Raty</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>NUMER_UMOWY_RAT</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <presorted>N</presorted>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>128</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Sort by wniosek</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>NUMER_UMOWY_ZAP</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <presorted>N</presorted>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Sort rows</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>NUMER_UMOWY_DEF</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <presorted>N</presorted>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>544</xloc>
      <yloc>560</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Sort rows 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>NUMER_UMOWY_WN</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <presorted>N</presorted>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>336</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Sort rows 3</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>NUMER_UMOWY_WN</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <presorted>N</presorted>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Status defaulted &#x3f;</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<send_true_to>Insert Defaulted</send_true_to>
<send_false_to>Dummy Filtr</send_false_to>
    <compare>
<condition>
 <negated>N</negated>
 <leftvalue>DEFAULTED_STATUS_DEF</leftvalue>
 <function>&#x3e;</function>
 <rightvalue/>
 <value><name>constant</name><type>String</type><text>0</text><length>-1</length><precision>-1</precision><isnull>N</isnull><mask/></value> </condition>
    </compare>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>544</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Status ods &#x3f;</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<send_true_to>Insert ODS</send_true_to>
<send_false_to>Dummy Filtr</send_false_to>
    <compare>
<condition>
 <negated>N</negated>
 <leftvalue>ODS_STAT</leftvalue>
 <function>&#x3e;</function>
 <rightvalue/>
 <value><name>constant</name><type>String</type><text>0</text><length>-1</length><precision>-1</precision><isnull>N</isnull><mask/></value> </condition>
    </compare>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>544</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>def ods all</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<join_type>FULL OUTER</join_type>
<step1>Count Rows</step1>
<step2>ODS and Def</step2>
    <keys_1>
    </keys_1>
    <keys_2>
    </keys_2>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>752</xloc>
      <yloc>272</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>umo and raty</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<join_type>LEFT OUTER</join_type>
<step1>Sort Nr Umowy</step1>
<step2>Sort Raty</step2>
    <keys_1>
      <key>NUMER_UMOWY_WN</key>
    </keys_1>
    <keys_2>
      <key>NUMER_UMOWY_RAT</key>
    </keys_2>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step_error_handling>
      <error>
        <source_step>Create JSON</source_step>
        <target_step/>
        <is_enabled>Y</is_enabled>
        <nr_valuename/>
        <descriptions_valuename/>
        <fields_valuename/>
        <codes_valuename/>
        <max_errors/>
        <max_pct_errors/>
        <min_pct_rows/>
      </error>
      <error>
        <source_step>Insert Data</source_step>
        <target_step>Abort</target_step>
        <is_enabled>Y</is_enabled>
        <nr_valuename/>
        <descriptions_valuename/>
        <fields_valuename/>
        <codes_valuename/>
        <max_errors/>
        <max_pct_errors/>
        <min_pct_rows/>
      </error>
      <error>
        <source_step>Insert Defaulted</source_step>
        <target_step>Abort</target_step>
        <is_enabled>Y</is_enabled>
        <nr_valuename/>
        <descriptions_valuename/>
        <fields_valuename/>
        <codes_valuename/>
        <max_errors/>
        <max_pct_errors/>
        <min_pct_rows/>
      </error>
  </step_error_handling>
   <slave-step-copy-partition-distribution>
</slave-step-copy-partition-distribution>
   <slave_transformation>N</slave_transformation>

</transformation>
